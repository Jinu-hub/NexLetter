slack_collection_task:
  description: >
    Ingest an existing Slack raw JSON (e.g., slack_raw.json) and
    structure conversations, threads, and reactions for {team/project}.
    (No new crawling/search.)

    Input schema (example):
    - message fields: ts, userInfo(id/name), text, reactions[], thread(replies[]), permalink
      per provided sample. :contentReference[oaicite:6]{index=6} :contentReference[oaicite:7]{index=7}

    Steps:
    1) Normalize: tsâ†’ISO time; userInfoâ†’display name; thread.reply_count
    2) Noise filter: drop/lowâ€‘weight empty auto posts
    3) Topic detection: Redmine/issue links, keywords (e.g., LEAD, ä¿®æ­£ä¾é ¼è¡¨)
    4) Importance scoring: reactions + thread length + mentions + keyword match
    5) Categorize: Announcement / Issue Discussion / Progress / Q&A / Decision
    6) Relevance scoring to {team/project}

  expected_output: >
    # Slack Activity Collection: {team/project}

    **Collection Summary**
    - Messages:
    - Threads (with replies):
    - Total reactions:
    - After filtering:
    - Collected at:

    ---

    ## Message 1
    **Author:**  
    **Time:**  
    **Oneâ€‘line gist:**  
    **Reactions/Thread:** ðŸ‘xN Â· N replies  
    **Category:** Announcement/Discussion/Decision â€¦  
    **Links:** [Permalink]  
    ---
  agent: slack_hunter_agent
  input_file: input/slack_raw.json
  markdown: true
  output_file: output/slack_collection.md
  create_directory: true

github_collection_task:
  description: >
    Ingest an existing GitHub raw JSON (e.g., github_raw.json) and
    structure commits/PR/issue activity for {team/project}. (No new API calls.)

    Input schema (example):
    - commits[].{ sha, message, author, html_url, date, userInfo }, etc.,
      per provided sample. :contentReference[oaicite:8]{index=8}

    Steps:
    1) Normalize: dateâ†’ISO; merge author/userInfo for display
    2) Detect issue/ticket refs from messages (#12345, ä¿®æ­£ä¾é ¼è¡¨)
    3) Change typing: tags like ä¿®æ­£/å‡ºåŠ›å¯¾å¿œ/ãƒ­ã‚°/ãƒãƒ¼ã‚¸ãƒ§ãƒ³
    4) Contributor rollup: counts per author, link to html_url
    5) Relevance scoring to {team/project}

  expected_output: >
    # GitHub Activity Collection: {team/project}

    **Collection Summary**
    - Commits:
    - Detected PR/Issue refs:
    - Contributors:
    - Collected at:

    ---

    ## Item 1 (Commit)
    **SHA:** â€¦  
    **Message:** â€¦ (highlight ticket IDs)  
    **Author:** â€¦  
    **Time:** â€¦  
    **Link:** â€¦  
    **Tags:** ä¿®æ­£/æ©Ÿèƒ½æ”¹ä¿®/å‡ºåŠ›/ãƒ­ã‚°/ãƒãƒ¼ã‚¸ãƒ§ãƒ³ â€¦  
    ---
  agent: github_hunter_agent
  input_file: input/github_raw.json
  markdown: true
  output_file: output/github_collection.md
  create_directory: true

internal_summarization_task:
  description: >
    Generate multiâ€‘level summaries based on the two collection outputs
    (slack_collection.md, github_collection.md) and the key context found
    in the original JSONs.

    Levels:
    1) **Oneâ€‘liner (â‰¤150 chars)** â€” decision/outcome
    2) **Team Briefing (150â€“200 words)** â€” significance/impact/risks/next steps
    3) **Comprehensive (400â€“600 words)** â€” background, discussion flow, stakeholders

    Principles:
    - Accuracy, objectivity, privacy (mask sensitive details)
    - Attach helpful links (Slack permalinks, commit URLs)

  expected_output: >
    # Internal Activity Summaries: {team/project}

    **Overview**
    - Items processed:
    - Generated at:

    ---

    ## Item 1: [Topic/Issue/Feature]
    **Source:** Slack/GitHub  
    **People:** â€¦  
    **Links:** [Slack] [Commit/Issue]

    ### âœ Oneâ€‘liner
    â€¦

    ### ðŸ“‹ Team Briefing
    â€¦

    ### ðŸ“– Comprehensive
    â€¦

    **Key Takeaways**
    - Progress:
    - Risks/Blockers:
    - Next steps:
    ---
  agent: summarizer_agent
  markdown: true
  output_file: output/internal_summary.md
  create_directory: true

newsletter_assembly_task:
  description: >
    Assemble the weekly internal newsletter from the summaries,
    applying editorial structure (sections, order, transitions) with intro/closing.

  expected_output: >
    # Weekly Internal Newsletter: {team/project}

    **Date of Issue:**  
    **Generated:**  
    **Stories Covered:**  

    ## ðŸ“° This Weekâ€™s Highlights
    â€¦

    ---

    ## ðŸš© Key Issues
    ### [Issue Title]
    [Team Briefing or Comprehensive]
    **Source:** Slack/GitHub Â· [Link]

    ---

    ## âš™ Work in Progress
    - â€¦

    ---

    ## ðŸŒ± Looking Ahead
    - â€¦

    ---

    ## âœ¨ Editorâ€™s Note
    â€¦
  agent: curator_agent
  markdown: true
  output_file: output/final_internal_newsletter.md
  create_directory: true
